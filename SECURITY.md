# 安全政策

## 支援版本

| 版本 | 是否支援          |
| ------- | ------------------ |
| 3.0.x   | :white_check_mark: |
| 2.0.x   | :white_check_mark: |
| < 2.0   | :x:                |

## 回報漏洞

我們非常重視 PaddleOCR Toolkit 的安全性。如果你發現了安全漏洞，請遵循以下步驟：

### 1. 請勿公開洩漏

在漏洞得到修復之前，請不要公開洩漏漏洞細節。

### 2. 私下回報

將安全詳情傳送郵件至：**security@paddleocr-toolkit.example.com** (請替換為實際郵箱)

請包含：

- 漏洞描述
- 重現步驟
- 潛在影響
- 建議的修復方案（如有）
- 您的聯絡方式

### 3. 回應時間

- 初步回應：48 小時內
- 狀態更新：7 天內
- 修復時間表：視嚴重程度而定
  - Critical: 24-48 小時
  - High: 7 天內
  - Medium: 30 天內

## v3.0 安全性改進

### 已實作的安全措施

1. **路徑遍歷保護**
   - 所有檔案操作使用 `Path.name` 清理檔名
   - 路徑驗證確保檔案在預期目錄內
   - 影響端點：檔案上傳、下載、刪除

2. **API Key 身份驗證**
   - 所有敏感端點需要 `X-API-Key` header
   - 使用環境變數管理 API Key
   - 基於 FastAPI Security 的中介層

3. **環境變數配置**
   - 敏感資訊不再硬編碼
   - 使用 `python-dotenv` 載入配置
   - 提供 `.env.example` 範本

4. **CORS 強化**
   - 可透過環境變數配置允許的來源
   - 預設為開發模式，生產環境需限制

5. **外掛目錄保護**
   - 啟動時檢查外掛目錄許可權
   - 可透過環境變數禁用外掛載入
   - 記錄安全性警告

詳細資訊請參閱 [SECURITY_HARDENING.md](docs/SECURITY_HARDENING.md)

## 安全最佳實踐

使用 PaddleOCR Toolkit 時：

1. **保持更新**：始終使用最新版本
2. **環境變數**：使用 `.env` 檔案管理敏感配置
3. **API Key**：生成強隨機 API Key（至少 32 字元）
4. **CORS**：生產環境限制 `ALLOWED_ORIGINS`
5. **HTTPS**：為 API 部署使用 HTTPS
6. **外掛目錄**：設定為唯讀（chmod 555）
7. **檔案許可權**：限制上傳目錄許可權
8. **稽核日誌**：啟用日誌紀錄以進行安全監控
9. **速率限制**：考慮新增速率限制中介層
10. **定期稽核**：定期檢查依賴項漏洞

## 部署檢查清單

部署到生產環境前：

- [x] **路徑遍歷保護**: 嚴格清理上傳、下載及刪除端點中的檔名。
- [x] **API 端點認證**: 敏感操作需經由 `X-API-Key` 認證。
- [x] **CORS 強化**: 限制允許的來源，禁用萬用字元 `*`。
- [x] **環境變數管理**: 使用 `.env` 與 `python-dotenv` 安全管理金鑰。
- [x] **外掛載入保護**: 檢查目錄許可權並提供全域性開關。為唯讀
- [ ] 啟用 HTTPS
- [ ] 配置防火牆規則
- [ ] 設定日誌監控
- [ ] 測試身份驗證
- [ ] 執行安全性掃描

## 已知問題

請檢視我們的 [安全公告](https://github.com/danwin47-sys/paddleocr-toolkit/security/advisories) 以瞭解已知問題。

## 安全性稽核歷史

- **2024-12-18**: v3.0 安全性稽核與強化
  - 修復路徑遍歷漏洞
  - 實作 API Key 驗證
  - 強化 CORS 設定
  - 新增外掛目錄保護
